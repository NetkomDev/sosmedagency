<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sosmed Agency - Analisis Menyeluruh</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --bg: #0F172A;
            --surface: #111827;
            --card: #1a2035;
            --border: rgba(255, 255, 255, 0.08);
            --text: #e2e8f0;
            --muted: #94a3b8;
            --accent: #38bdf8;
            --green: #22c55e;
            --red: #ef4444;
            --yellow: #eab308;
            --purple: #a855f7;
            --pink: #ec4899;
            --orange: #f97316;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        /* Hero */
        .hero {
            text-align: center;
            padding: 3rem 0 2rem;
            position: relative;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 600px;
            height: 300px;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.15), transparent 70%);
            pointer-events: none;
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent), var(--purple));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .hero p {
            color: var(--muted);
            font-size: 1.1rem;
        }

        .badge {
            display: inline-block;
            background: rgba(56, 189, 248, 0.15);
            color: var(--accent);
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-bottom: 1rem;
            border: 1px solid rgba(56, 189, 248, 0.2);
        }

        /* Stats Grid */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1.25rem;
            text-align: center;
            transition: transform 0.2s, border-color 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent);
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: 800;
        }

        .stat-card .label {
            color: var(--muted);
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        /* Sections */
        .section {
            margin: 2.5rem 0;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title i {
            color: var(--accent);
        }

        /* Cards Grid */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 1.25rem;
        }

        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: border-color 0.3s;
        }

        .card:hover {
            border-color: rgba(56, 189, 248, 0.3);
        }

        .card h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card ul {
            list-style: none;
        }

        .card li {
            padding: 0.4rem 0;
            font-size: 0.875rem;
            color: var(--muted);
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .card li::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-top: 7px;
            flex-shrink: 0;
        }

        .card li.green::before {
            background: var(--green);
        }

        .card li.yellow::before {
            background: var(--yellow);
        }

        .card li.red::before {
            background: var(--red);
        }

        .card li.blue::before {
            background: var(--accent);
        }

        .card li.purple::before {
            background: var(--purple);
        }

        /* Architecture */
        .arch-flow {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            align-items: center;
            margin: 1.5rem 0;
        }

        .arch-box {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            padding: 1rem 1.5rem;
            text-align: center;
            min-width: 140px;
        }

        .arch-box .icon {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .arch-box .name {
            font-weight: 700;
            font-size: 0.9rem;
        }

        .arch-box .sub {
            color: var(--muted);
            font-size: 0.7rem;
        }

        .arch-arrow {
            color: var(--accent);
            font-size: 1.5rem;
        }

        /* Tables */
        .table-wrap {
            overflow-x: auto;
            border-radius: 0.75rem;
            border: 1px solid var(--border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        th {
            background: rgba(56, 189, 248, 0.1);
            color: var(--accent);
            text-align: left;
            padding: 0.75rem 1rem;
            font-weight: 700;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        td {
            padding: 0.6rem 1rem;
            border-top: 1px solid var(--border);
            color: var(--muted);
        }

        tr:hover td {
            background: rgba(255, 255, 255, 0.02);
        }

        /* Tags */
        .tag {
            display: inline-block;
            padding: 0.15rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.7rem;
            font-weight: 700;
        }

        .tag-green {
            background: rgba(34, 197, 94, 0.15);
            color: var(--green);
        }

        .tag-yellow {
            background: rgba(234, 179, 8, 0.15);
            color: var(--yellow);
        }

        .tag-red {
            background: rgba(239, 68, 68, 0.15);
            color: var(--red);
        }

        .tag-blue {
            background: rgba(56, 189, 248, 0.15);
            color: var(--accent);
        }

        .tag-purple {
            background: rgba(168, 85, 247, 0.15);
            color: var(--purple);
        }

        /* Accordion */
        .accordion {
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }

        .accordion-header {
            background: var(--card);
            padding: 1rem 1.25rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            font-size: 0.95rem;
            transition: background 0.2s;
        }

        .accordion-header:hover {
            background: rgba(56, 189, 248, 0.05);
        }

        .accordion-body {
            display: none;
            padding: 1rem 1.25rem;
            background: var(--surface);
            font-size: 0.85rem;
            color: var(--muted);
            line-height: 1.8;
        }

        .accordion.open .accordion-body {
            display: block;
        }

        .accordion.open .accordion-header .chevron {
            transform: rotate(180deg);
        }

        .chevron {
            transition: transform 0.2s;
            color: var(--muted);
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }

            .hero h1 {
                font-size: 1.75rem;
            }

            .stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .arch-flow {
                flex-direction: column;
            }

            .arch-arrow {
                transform: rotate(90deg);
            }
        }
    </style>
</head>

<body>
    <!-- Floating Nav -->
    <div
        style="position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(10,14,26,0.9);backdrop-filter:blur(16px);border-bottom:1px solid rgba(99,102,241,0.15);padding:0.75rem 1.5rem;display:flex;align-items:center;justify-content:space-between;">
        <div style="display:flex;align-items:center;gap:1rem;">
            <a href="admin.html"
                style="color:#94a3b8;text-decoration:none;font-size:0.8rem;display:flex;align-items:center;gap:0.4rem;transition:color 0.2s;"
                onmouseover="this.style.color='#22d3ee'" onmouseout="this.style.color='#94a3b8'">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                Admin Panel
            </a>
            <span style="color:rgba(99,102,241,0.3)">|</span>
            <a href="dashboard.html" style="color:#94a3b8;text-decoration:none;font-size:0.8rem;transition:color 0.2s;"
                onmouseover="this.style.color='#22d3ee'" onmouseout="this.style.color='#94a3b8'">üìä Dashboard</a>
        </div>
        <span style="font-size:0.7rem;color:#64748b;font-weight:600;letter-spacing:0.05em;">SYSTEM ANALYSIS</span>
    </div>

    <div class="container" style="padding-top:4rem;">

        <!-- Hero -->
        <div class="hero">
            <div class="badge">üìä COMPREHENSIVE ANALYSIS REPORT</div>
            <h1>Sosmed Agency</h1>
            <p>Digital Growth Agency ‚Äî Analisis Arsitektur, Fitur, Database, dan Keamanan</p>
        </div>

        <!-- Overview Stats -->
        <div class="stats">
            <div class="stat-card">
                <div class="value" style="color:var(--accent)">4</div>
                <div class="label">Komponen Utama</div>
            </div>
            <div class="stat-card">
                <div class="value" style="color:var(--green)">13</div>
                <div class="label">File Frontend</div>
            </div>
            <div class="stat-card">
                <div class="value" style="color:var(--purple)">7</div>
                <div class="label">Tabel Database</div>
            </div>
            <div class="stat-card">
                <div class="value" style="color:var(--orange)">14</div>
                <div class="label">Migration Files</div>
            </div>
            <div class="stat-card">
                <div class="value" style="color:var(--pink)">7</div>
                <div class="label">Platform Supported</div>
            </div>
        </div>

        <!-- 1. Ringkasan Aplikasi -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-rocket"></i> Ringkasan Aplikasi</h2>
            <div class="card" style="border-left: 3px solid var(--accent);">
                <p style="margin-bottom:1rem;"><strong>Sosmed Agency</strong> adalah platform
                    <strong>"Engagement-as-a-Service"</strong> yang menghubungkan pemilik bisnis (klien) dengan pekerja
                    mikro (pasukan) melalui Telegram Bot. Klien memesan paket engagement (review, like, follow, comment)
                    melalui landing page, admin memverifikasi pembayaran dan membuat misi, lalu pasukan mengerjakan misi
                    dan mendapat cuan.
                </p>
                <p style="color:var(--muted); font-size:0.85rem;"><strong>Tech Stack:</strong> HTML/TailwindCSS
                    (Frontend) ¬∑ Node.js + Telegraf (Bot) ¬∑ Supabase (Database + Storage + Auth + Edge Functions) ¬∑
                    Gemini AI (Comment Generation + Proof Verification)</p>
            </div>
        </div>

        <!-- 2. Arsitektur -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-sitemap"></i> Arsitektur Sistem</h2>
            <div class="arch-flow">
                <div class="arch-box">
                    <div class="icon">üåê</div>
                    <div class="name">Landing Page</div>
                    <div class="sub">index.html</div>
                </div>
                <div class="arch-arrow">‚Üí</div>
                <div class="arch-box">
                    <div class="icon">üí≥</div>
                    <div class="name">Checkout</div>
                    <div class="sub">QRIS + WhatsApp</div>
                </div>
                <div class="arch-arrow">‚Üí</div>
                <div class="arch-box">
                    <div class="icon">üõ°Ô∏è</div>
                    <div class="name">Admin Panel</div>
                    <div class="sub">admin.html</div>
                </div>
                <div class="arch-arrow">‚Üí</div>
                <div class="arch-box">
                    <div class="icon">ü§ñ</div>
                    <div class="name">Telegram Bot</div>
                    <div class="sub">Telegraf + Node.js</div>
                </div>
                <div class="arch-arrow">‚Üí</div>
                <div class="arch-box">
                    <div class="icon">üß†</div>
                    <div class="name">Gemini AI</div>
                    <div class="sub">Generate + Verify</div>
                </div>
            </div>
            <div class="arch-flow">
                <div class="arch-box" style="border-color: rgba(34,197,94,0.3);">
                    <div class="icon">üóÑÔ∏è</div>
                    <div class="name">Supabase</div>
                    <div class="sub">PostgreSQL + RLS + Realtime + Storage</div>
                </div>
            </div>
        </div>

        <!-- 3. Komponen Detail -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-puzzle-piece"></i> Komponen Detail</h2>
            <div class="grid-2">

                <!-- Landing Page -->
                <div class="card">
                    <h3><span style="color:var(--accent)">üåê</span> Landing Page (index.html)</h3>
                    <ul>
                        <li class="green">Hero section dengan gradient & CTA yang menarik</li>
                        <li class="green">Stats section (10k+ pasukan, 50k+ misi, 99% kepuasan)</li>
                        <li class="green">3 kategori layanan: UMKM/Google Maps, Social Media, Marketplace</li>
                        <li class="green">Dynamic pricing dari Supabase (packages table)</li>
                        <li class="green">Tab switcher: TikTok, YouTube, IG, FB, Shopee, TikTok Shop</li>
                        <li class="green">Checkout modal dengan form pemesanan lengkap</li>
                        <li class="green">Payment modal (QRIS) dengan kode unik 3 digit</li>
                        <li class="green">Bilingual support (ID/EN) via translations.json</li>
                        <li class="blue">Custom Campaign section (Paket Trending Rp 2jt+)</li>
                        <li class="blue">Trust badges: Real Human, Bebas Banned, Algoritma Friendly</li>
                    </ul>
                </div>

                <!-- Admin Dashboard -->
                <div class="card">
                    <h3><span style="color:var(--purple)">üõ°Ô∏è</span> Admin Dashboard (admin.html)</h3>
                    <ul>
                        <li class="green">Login via Supabase Auth (email/password)</li>
                        <li class="green">Order management: Verify, Reject, Reset</li>
                        <li class="green">Auto-split fitur paket ‚Üí misi individual</li>
                        <li class="green">Active missions CRUD dengan progress tracking</li>
                        <li class="green">Package editor dengan Feature Builder & Profit Calculator</li>
                        <li class="green">Submission review (Approve/Reject bukti pasukan)</li>
                        <li class="green">Settings management (WhatsApp, QRIS, judul site)</li>
                        <li class="purple">AI Comment auto-generation saat verifikasi order</li>
                        <li class="blue">Realtime updates via Supabase channel</li>
                        <li class="blue">Margin analysis (30-40% target profit)</li>
                    </ul>
                </div>

                <!-- Telegram Bot -->
                <div class="card">
                    <h3><span style="color:var(--green)">ü§ñ</span> Telegram Bot (bot/)</h3>
                    <ul>
                        <li class="green">Menu utama: Daftar Misi, Dompet Saya, Profil, Bantuan</li>
                        <li class="green">Random mission picker dengan inline keyboard</li>
                        <li class="green">Platform-specific task descriptions (GMaps, Shopee, dll)</li>
                        <li class="green">AI comment pooling: Ambil komentar dari mission_tasks</li>
                        <li class="green">Photo submission handler untuk bukti kerja</li>
                        <li class="green">Auto-retry failed AI requests (setiap 5 menit)</li>
                        <li class="purple">AI Verification: Gemini menganalisis screenshot bukti</li>
                        <li class="purple">Image deduplication via SHA-256 hash</li>
                        <li class="blue">Upload bukti ke Supabase Storage (compressed JPEG)</li>
                        <li class="blue">Balance auto-increment saat bukti approved</li>
                    </ul>
                </div>

                <!-- Gemini AI -->
                <div class="card">
                    <h3><span style="color:var(--pink)">üß†</span> Gemini AI Integration</h3>
                    <ul>
                        <li class="green">7 platform-specific prompt templates</li>
                        <li class="green">Batch generation (15 per batch, 5s delay)</li>
                        <li class="green">Auto-retry dengan exponential backoff (30s, 60s, 90s)</li>
                        <li class="green">Rate limit handling (429, Quota, RESOURCE_EXHAUSTED)</li>
                        <li class="purple">Proof verification: Cyber Security Agent persona</li>
                        <li class="purple">Contextual time check (status bar vs server time)</li>
                        <li class="purple">Photo manipulation detection</li>
                        <li class="blue">Platform-specific validation (Follow‚Üíicon, Like‚Üícolor, dll)</li>
                        <li class="yellow">Model: gemini-3-flash-preview (generate) + gemini-1.5-flash (verify)</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 4. Database Schema -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-database"></i> Database Schema</h2>
            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Tabel</th>
                            <th>Primary Key</th>
                            <th>Kolom Utama</th>
                            <th>RLS</th>
                            <th>Fungsi</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>profiles</strong></td>
                            <td>bigint (Telegram ID)</td>
                            <td>username, balance, phone_number</td>
                            <td><span class="tag tag-green">‚úì + Trigger</span></td>
                            <td>Data user/pasukan dari Telegram</td>
                        </tr>
                        <tr>
                            <td><strong>missions</strong></td>
                            <td>UUID</td>
                            <td>category, platform_type, title, link, reward, quota, status</td>
                            <td><span class="tag tag-green">‚úì</span></td>
                            <td>Misi yang harus dikerjakan pasukan</td>
                        </tr>
                        <tr>
                            <td><strong>submissions</strong></td>
                            <td>UUID</td>
                            <td>user_id‚Üíprofiles, mission_id‚Üímissions, proof_url, status, image_hash</td>
                            <td><span class="tag tag-green">‚úì Auth Only</span></td>
                            <td>Bukti kerja dari pasukan</td>
                        </tr>
                        <tr>
                            <td><strong>orders</strong></td>
                            <td>UUID</td>
                            <td>client_name, client_whatsapp, package_name, social_link, total_price, status</td>
                            <td><span class="tag tag-green">‚úì Auth Only</span></td>
                            <td>Pesanan klien dari landing page</td>
                        </tr>
                        <tr>
                            <td><strong>packages</strong></td>
                            <td>UUID</td>
                            <td>category, sub_category, name, price, features (JSONB), is_best_value</td>
                            <td><span class="tag tag-green">‚úì</span></td>
                            <td>Paket layanan & harga</td>
                        </tr>
                        <tr>
                            <td><strong>app_settings</strong></td>
                            <td>text (key)</td>
                            <td>value, description</td>
                            <td><span class="tag tag-green">‚úì</span></td>
                            <td>Konfigurasi global (WA, QRIS, judul)</td>
                        </tr>
                        <tr>
                            <td><strong>mission_tasks</strong></td>
                            <td>UUID</td>
                            <td>mission_id, comment_text, is_taken, taken_by_user_id</td>
                            <td><span class="tag tag-green">‚úì</span></td>
                            <td>Pool komentar AI untuk distribusi</td>
                        </tr>
                        <tr>
                            <td><strong>ai_requests</strong></td>
                            <td>UUID</td>
                            <td>mission_id, context, tone, quantity, status, result</td>
                            <td><span class="tag tag-green">‚úì</span></td>
                            <td>Queue & tracking AI generation</td>
                        </tr>
                        <tr style="background:rgba(34,197,94,0.05);">
                            <td><strong>admin_roles</strong> <span class="tag tag-green">NEW</span></td>
                            <td>UUID (auth.users FK)</td>
                            <td>role, created_at</td>
                            <td><span class="tag tag-green">‚úì Bootstrap</span></td>
                            <td>Kontrol akses admin multi-level</td>
                        </tr>
                        <tr style="background:rgba(34,197,94,0.05);">
                            <td><strong>user_states</strong> <span class="tag tag-green">NEW</span></td>
                            <td>bigint (user_id)</td>
                            <td>mission_id, status, assigned_comment, start_time</td>
                            <td><span class="tag tag-green">‚úì</span></td>
                            <td>Bot state persistence (survive restart)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 5. Alur Bisnis -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-arrows-spin"></i> Alur Bisnis (Business Flow)</h2>
            <div class="grid-2">
                <div class="card" style="border-left: 3px solid var(--green);">
                    <h3>üí∞ Alur Klien (Pembeli)</h3>
                    <ol
                        style="list-style:decimal; padding-left:1.25rem; color:var(--muted); font-size:0.85rem; line-height:2;">
                        <li>Buka landing page ‚Üí Pilih kategori & paket</li>
                        <li>Isi form checkout (nama, WA, link target)</li>
                        <li>Khusus GMaps: isi detail bisnis untuk AI context</li>
                        <li>Bayar via QRIS (harga + kode unik 3 digit)</li>
                        <li>Konfirmasi pembayaran via WhatsApp ke admin</li>
                        <li>Admin verifikasi ‚Üí Misi dibuat otomatis</li>
                        <li>AI generate komentar ‚Üí Pasukan kerjakan misi</li>
                    </ol>
                </div>
                <div class="card" style="border-left: 3px solid var(--accent);">
                    <h3>üéØ Alur Pasukan (Pekerja)</h3>
                    <ol
                        style="list-style:decimal; padding-left:1.25rem; color:var(--muted); font-size:0.85rem; line-height:2;">
                        <li>Start bot Telegram ‚Üí Register otomatis</li>
                        <li>Klik "üìã Daftar Misi" ‚Üí Random misi muncul</li>
                        <li>"üöÄ AMBIL MISI INI" ‚Üí Terima instruksi detail</li>
                        <li>Jika Comment/Review: AI komentar diberikan (tap to copy)</li>
                        <li>Kerjakan misi di platform target</li>
                        <li>Kirim screenshot bukti ke bot</li>
                        <li>AI verify ‚Üí Auto-approve / Manual review</li>
                        <li>Saldo bertambah ‚Üí Cairkan via admin (min Rp 50k)</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- 6. Platform Support -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-globe"></i> Platform Support</h2>
            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Platform</th>
                            <th>Tipe Aksi</th>
                            <th>AI Prompt</th>
                            <th>Harga Paket</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><i class="fa-brands fa-google" style="color:#4285f4"></i> <strong>Google Maps</strong>
                            </td>
                            <td>Review + Rating ‚≠ê5</td>
                            <td><span class="tag tag-green">‚úì Khusus</span></td>
                            <td>Rp 199k - 449k</td>
                        </tr>
                        <tr>
                            <td><i class="fa-brands fa-tiktok" style="color:#ff0050"></i> <strong>TikTok</strong></td>
                            <td>Views, Followers, Likes, Shares</td>
                            <td><span class="tag tag-green">‚úì Khusus</span></td>
                            <td>Rp 199k - 449k</td>
                        </tr>
                        <tr>
                            <td><i class="fa-brands fa-youtube" style="color:#ff0000"></i> <strong>YouTube</strong></td>
                            <td>Subs, Views, Likes, Comments</td>
                            <td><span class="tag tag-green">‚úì Khusus</span></td>
                            <td>Rp 299k - 599k</td>
                        </tr>
                        <tr>
                            <td><i class="fa-brands fa-instagram" style="color:#e1306c"></i> <strong>Instagram</strong>
                            </td>
                            <td>Followers, Likes, Comments</td>
                            <td><span class="tag tag-green">‚úì Khusus</span></td>
                            <td>Rp 99k - 199k</td>
                        </tr>
                        <tr>
                            <td><i class="fa-brands fa-facebook" style="color:#1877f2"></i> <strong>Facebook</strong>
                            </td>
                            <td>Followers, Page Likes</td>
                            <td><span class="tag tag-green">‚úì Khusus</span></td>
                            <td>Rp 99k - 199k</td>
                        </tr>
                        <tr>
                            <td><i class="fa-solid fa-bag-shopping" style="color:#ee4d2d"></i> <strong>Shopee</strong>
                            </td>
                            <td>Review + Rating ‚≠ê5</td>
                            <td><span class="tag tag-green">‚úì Khusus</span></td>
                            <td>Dynamic</td>
                        </tr>
                        <tr>
                            <td><i class="fa-solid fa-bag-shopping" style="color:#69c9d0"></i> <strong>TikTok
                                    Shop</strong></td>
                            <td>Review + Rating ‚≠ê5</td>
                            <td><span class="tag tag-green">‚úì Khusus</span></td>
                            <td>Dynamic</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 7. Perbaikan Keamanan (Updated) -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-shield-halved"></i> Perbaikan Keamanan & Status</h2>
            <div class="grid-2">
                <div class="card" style="border-left: 3px solid var(--green);">
                    <h3><span style="color:var(--green)">‚úÖ</span> Masalah yang Sudah Diperbaiki</h3>
                    <ul>
                        <li class="green"><strong>RLS Diperkuat</strong> ‚Äî Orders & Submissions UPDATE hanya
                            authenticated. Balance dilindungi trigger SECURITY DEFINER.</li>
                        <li class="green"><strong>Admin Role Check</strong> ‚Äî Tabel admin_roles + fungsi is_admin() +
                            bootstrap_admin(). User pertama otomatis jadi super_admin.</li>
                        <li class="green"><strong>Service Role Key di Bot</strong> ‚Äî Bot sekarang support
                            SUPABASE_SERVICE_KEY (bypass RLS untuk operasi server).</li>
                        <li class="green"><strong>Rate Limiting</strong> ‚Äî Checkout form dibatasi 1 order per 30 detik
                            per session.</li>
                        <li class="green"><strong>Input Sanitization</strong> ‚Äî escapeHtml() pada admin-render.js
                            mencegah XSS dari data klien.</li>
                        <li class="green"><strong>Balance Protection</strong> ‚Äî Trigger protect_balance_change()
                            memblokir manipulasi saldo langsung. Hanya via RPC increment_balance().</li>
                        <li class="green"><strong>Bot State Persistent</strong> ‚Äî userStates dipindahkan dari in-memory
                            ke tabel user_states (survive restart).</li>
                        <li class="green"><strong>Package Caching</strong> ‚Äî Landing page meng-cache packages di
                            localStorage (TTL 5 menit).</li>
                        <li class="green"><strong>Admin Notification</strong> ‚Äî Bot mengirim notifikasi Telegram ke
                            admin saat ada order baru (via ADMIN_CHAT_ID env).</li>
                    </ul>
                </div>
                <div class="card" style="border-left: 3px solid var(--accent);">
                    <h3><span style="color:var(--accent)">üìã</span> Catatan Konfigurasi</h3>
                    <ul>
                        <li class="blue"><strong>SUPABASE_SERVICE_KEY</strong> ‚Äî Tambahkan ke bot/.env untuk keamanan
                            optimal (bypass RLS di server).</li>
                        <li class="blue"><strong>ADMIN_CHAT_ID</strong> ‚Äî Tambahkan Telegram chat ID admin ke bot/.env
                            untuk notifikasi order baru.</li>
                        <li class="blue"><strong>Admin Pertama</strong> ‚Äî Login pertama ke admin panel otomatis menjadi
                            super_admin via bootstrap_admin().</li>
                        <li class="yellow"><strong>Multi-Admin</strong> ‚Äî Super admin bisa menambah admin lain via tabel
                            admin_roles di Supabase Dashboard.</li>
                        <li class="yellow"><strong>Edge Function</strong> ‚Äî AI generation bisa dipindah ke Supabase Edge
                            Function untuk performa lebih baik (future improvement).</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 8. Detail Implementasi -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-code"></i> Detail Implementasi Perbaikan</h2>

            <div class="accordion open" onclick="this.classList.toggle('open')">
                <div class="accordion-header">üîí Keamanan <span class="tag tag-green" style="margin-left:0.5rem">5/5
                        DONE</span><span class="chevron">‚ñº</span></div>
                <div class="accordion-body">
                    <strong>1. ‚úÖ RLS Policies Diperkuat:</strong> Orders & Submissions UPDATE dibatasi ke authenticated
                    users saja. Balance dilindungi oleh trigger yang hanya mengizinkan perubahan via RPC function
                    SECURITY DEFINER.<br>
                    <strong>2. ‚úÖ Admin Role Check:</strong> Tabel admin_roles dibuat dengan bootstrap mechanism. Fungsi
                    is_admin() & bootstrap_admin() sebagai RPC. Admin.js sekarang cek role sebelum memuat dashboard.<br>
                    <strong>3. ‚úÖ Service Role Key:</strong> Bot index.js diupdate untuk memprioritaskan
                    SUPABASE_SERVICE_KEY. Log menunjukkan key yang digunakan.<br>
                    <strong>4. ‚úÖ Rate Limiting:</strong> Checkout form sekarang memiliki cooldown 30 detik antara setiap
                    submit.<br>
                    <strong>5. ‚úÖ Input Sanitization:</strong> Fungsi escapeHtml() ditambahkan ke admin-render.js dan
                    diterapkan pada semua data user-generated.
                </div>
            </div>

            <div class="accordion" onclick="this.classList.toggle('open')">
                <div class="accordion-header">üöÄ Performa & Skalabilitas <span class="tag tag-green"
                        style="margin-left:0.5rem">2/3 DONE</span><span class="chevron">‚ñº</span></div>
                <div class="accordion-body">
                    <strong>1. ‚úÖ Bot State Persistent:</strong> In-memory userStates diganti dengan tabel user_states di
                    Supabase. Helper functions getState(), setState(), clearState() mengelola CRUD. State survive saat
                    bot restart.<br>
                    <strong>2. ‚úÖ Package Caching:</strong> fetchPackages() di landing page sekarang menyimpan data ke
                    localStorage dengan TTL 5 menit. Mengurangi query Supabase pada repeat visits.<br>
                    <strong>3. ‚è≥ Edge Function Migration:</strong> Infrastruktur sudah disiapkan (supabase/functions/).
                    Full migration ke Edge Function bisa dilakukan sebagai improvement berikutnya.
                </div>
            </div>

            <div class="accordion" onclick="this.classList.toggle('open')">
                <div class="accordion-header">üí° Fitur Baru <span class="tag tag-green" style="margin-left:0.5rem">2/3
                        DONE</span><span class="chevron">‚ñº</span></div>
                <div class="accordion-body">
                    <strong>1. ‚úÖ Notification System:</strong> Bot sekarang mendengarkan INSERT baru di tabel orders via
                    Supabase Realtime. Notifikasi dikirim ke ADMIN_CHAT_ID melalui Telegram.<br>
                    <strong>2. ‚úÖ Multi-Admin Support:</strong> Tabel admin_roles mendukung multiple admin dengan role
                    berbeda (admin, super_admin). RLS policy mengizinkan super_admin menambah admin baru.<br>
                    <strong>3. ‚è≥ Dashboard Analytics & Withdrawal:</strong> Bisa ditambahkan di tahap berikutnya.
                </div>
            </div>
        </div>

        <!-- 9. Database Functions -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-gears"></i> Database Functions & Triggers</h2>
            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Nama</th>
                            <th>Tipe</th>
                            <th>Security</th>
                            <th>Fungsi</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>increment_balance(user_id, amount)</strong></td>
                            <td>RPC Function</td>
                            <td><span class="tag tag-green">SECURITY DEFINER</span></td>
                            <td>Satu-satunya cara aman menambah saldo user</td>
                        </tr>
                        <tr>
                            <td><strong>decrement_quota(mission_id)</strong></td>
                            <td>RPC Function</td>
                            <td><span class="tag tag-green">SECURITY DEFINER</span></td>
                            <td>Mengurangi quota misi secara aman</td>
                        </tr>
                        <tr>
                            <td><strong>is_admin()</strong></td>
                            <td>RPC Function</td>
                            <td><span class="tag tag-green">SECURITY DEFINER</span></td>
                            <td>Cek apakah user saat ini adalah admin</td>
                        </tr>
                        <tr>
                            <td><strong>bootstrap_admin()</strong></td>
                            <td>RPC Function</td>
                            <td><span class="tag tag-green">SECURITY DEFINER</span></td>
                            <td>Auto-register user pertama sebagai super_admin</td>
                        </tr>
                        <tr>
                            <td><strong>protect_balance_change()</strong></td>
                            <td>Trigger (BEFORE UPDATE)</td>
                            <td><span class="tag tag-purple">Trigger Guard</span></td>
                            <td>Blokir manipulasi balance langsung (hanya via RPC)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 10. File Structure -->
        <div class="section">
            <h2 class="section-title"><i class="fa-solid fa-folder-tree"></i> Struktur File</h2>
            <div class="card" style="font-family: monospace; font-size: 0.8rem; line-height: 2; color: var(--muted);">
                <pre style="overflow-x:auto;">
Sosmed Agency/
‚îú‚îÄ‚îÄ üìÑ README.md
‚îú‚îÄ‚îÄ üåê web/                          <span style="color:var(--accent)"># Frontend</span>
‚îÇ   ‚îú‚îÄ‚îÄ index.html      (71 KB)      <span style="color:var(--muted)"># Landing Page</span> <span style="color:var(--green)">[+ Package Cache]</span>
‚îÇ   ‚îú‚îÄ‚îÄ admin.html      (76.5 KB)    <span style="color:var(--muted)"># Admin Dashboard</span>
‚îÇ   ‚îú‚îÄ‚îÄ login.html      (3.9 KB)     <span style="color:var(--muted)"># Admin Login</span>
‚îÇ   ‚îú‚îÄ‚îÄ checkout.js     (20 KB)      <span style="color:var(--muted)"># Checkout Logic</span> <span style="color:var(--green)">[+ Rate Limit]</span>
‚îÇ   ‚îú‚îÄ‚îÄ admin.js        (71 KB)      <span style="color:var(--muted)"># Admin Logic</span> <span style="color:var(--green)">[+ Role Check + RPC Balance]</span>
‚îÇ   ‚îú‚îÄ‚îÄ api.js          (3.6 KB)     <span style="color:var(--muted)"># Supabase API Layer</span>
‚îÇ   ‚îú‚îÄ‚îÄ admin-render.js (9.6 KB)     <span style="color:var(--muted)"># HTML Renderers</span> <span style="color:var(--green)">[+ XSS Protection]</span>
‚îÇ   ‚îú‚îÄ‚îÄ mission-logic.js(18.2 KB)    <span style="color:var(--muted)"># Mission Processing</span>
‚îÇ   ‚îú‚îÄ‚îÄ ui-handlers.js  (8.3 KB)     <span style="color:var(--muted)"># UI Event Handlers</span>
‚îÇ   ‚îú‚îÄ‚îÄ supabase.js     (0.5 KB)     <span style="color:var(--muted)"># Supabase Config</span>
‚îÇ   ‚îú‚îÄ‚îÄ translations.json(9.9 KB)    <span style="color:var(--muted)"># i18n Data</span>
‚îÇ   ‚îú‚îÄ‚îÄ analysis.html                <span style="color:var(--accent)"># Analisis Komprehensif</span>
‚îÇ   ‚îî‚îÄ‚îÄ style.css       (0.2 KB)     <span style="color:var(--muted)"># Minimal Custom CSS</span>
‚îú‚îÄ‚îÄ ü§ñ bot/                          <span style="color:var(--green)"># Telegram Bot</span>
‚îÇ   ‚îú‚îÄ‚îÄ index.js        (7 KB)       <span style="color:var(--muted)"># Entry Point</span> <span style="color:var(--green)">[+ Service Key + Notification]</span>
‚îÇ   ‚îú‚îÄ‚îÄ handler.js      (20 KB)      <span style="color:var(--muted)"># Command Handlers</span> <span style="color:var(--green)">[+ Persistent State]</span>
‚îÇ   ‚îú‚îÄ‚îÄ gemini.js       (8.2 KB)     <span style="color:var(--muted)"># AI Comment Generation</span>
‚îÇ   ‚îú‚îÄ‚îÄ ai-verification.js(6.5 KB)   <span style="color:var(--muted)"># Proof Verification</span>
‚îÇ   ‚îú‚îÄ‚îÄ logger.js       (0.9 KB)     <span style="color:var(--muted)"># Logging Utility</span>
‚îÇ   ‚îî‚îÄ‚îÄ .env                         <span style="color:var(--muted)"># Environment Variables</span>
‚îú‚îÄ‚îÄ üóÑÔ∏è db/                           <span style="color:var(--purple)"># Database</span>
‚îÇ   ‚îú‚îÄ‚îÄ schema.sql      (8.3 KB)     <span style="color:var(--muted)"># Main Schema + Seed</span>
‚îÇ   ‚îú‚îÄ‚îÄ schema.json     (33.5 KB)    <span style="color:var(--muted)"># Schema Export</span>
‚îÇ   ‚îú‚îÄ‚îÄ migrations/     (15 files)   <span style="color:var(--muted)"># Migration History</span> <span style="color:var(--green)">[+ security_improvements]</span>
‚îÇ   ‚îî‚îÄ‚îÄ maintenance/    (7 files)    <span style="color:var(--muted)"># Maintenance Scripts</span>
‚îî‚îÄ‚îÄ ‚òÅÔ∏è supabase/
    ‚îî‚îÄ‚îÄ functions/                    <span style="color:var(--muted)"># Edge Functions</span>
            </pre>
            </div>
        </div>

        <!-- Footer -->
        <div
            style="text-align:center; padding: 2rem 0; color: var(--muted); font-size: 0.8rem; border-top: 1px solid var(--border); margin-top: 2rem;">
            <p>üìä Analisis & Perbaikan diterapkan pada <strong>19 Februari 2026</strong> ¬∑ Sosmed Agency v1.1</p>
            <p style="margin-top:0.25rem;">Supabase Project: <code
                    style="background:var(--card);padding:0.15rem 0.5rem;border-radius:0.25rem;">uvrtlenmjpueahwydomo</code>
            </p>
            <p style="margin-top:0.5rem;"><span class="tag tag-green">9 Perbaikan Diterapkan</span> <span
                    class="tag tag-blue" style="margin-left:0.5rem;">2 Tabel Baru</span> <span class="tag tag-purple"
                    style="margin-left:0.5rem;">5 DB Functions</span></p>
        </div>
    </div>
</body>

</html>